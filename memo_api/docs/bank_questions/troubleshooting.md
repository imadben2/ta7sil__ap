# حل المشاكل الشائعة

## مشاكل رفع الملف

### ❌ المشكلة: "الملف كبير جداً"

**الأعراض**:
```
حجم الملف أكبر من 10 ميجابايت!
```

**الأسباب**:
- حجم ملف Excel يتجاوز 10 MB
- الملف يحتوي على صور أو تنسيقات ثقيلة

**الحلول**:
1. ✅ احذف أي صور أو تنسيقات غير ضرورية
2. ✅ قسم الأسئلة إلى ملفات أصغر (50-100 سؤال لكل ملف)
3. ✅ احفظ الملف بصيغة .xlsx (ليس .xls القديمة)
4. ✅ استخدم ضغط ZIP قبل الرفع (إن أمكن)

---

### ❌ المشكلة: "نوع الملف غير مدعوم"

**الأعراض**:
```
نوع الملف غير مدعوم! يرجى رفع ملف Excel أو CSV.
```

**الأسباب**:
- تم رفع ملف بتنسيق غير مدعوم (.doc, .pdf, .txt...)
- امتداد الملف تم تغييره يدوياً

**الحلول**:
1. ✅ تأكد من أن الملف بامتداد .xlsx أو .xls أو .csv
2. ✅ لا تغير امتداد الملف يدوياً
3. ✅ احفظ الملف من Excel مباشرة بصيغة Excel Workbook

---

### ❌ المشكلة: "ملف Excel فارغ"

**الأعراض**:
```
ملف Excel فارغ أو لا يحتوي على أسئلة صالحة
```

**الأسباب**:
- الملف لا يحتوي على أي أسطر (فقط العناوين)
- جميع الأسطر فارغة أو غير صالحة
- الأعمدة المطلوبة مفقودة

**الحلول**:
1. ✅ تأكد من وجود أسئلة في الملف (ابدأ من السطر 2)
2. ✅ لا تحذف أو تعيد تسمية الأعمدة
3. ✅ تأكد من تعبئة الحقول المطلوبة

---

## مشاكل التنسيق

### ❌ المشكلة: "نوع السؤال غير صحيح"

**الأعراض**:
```
السطر 5: نوع السؤال غير صحيح: MCQ
```

**الأسباب**:
- استخدام قيمة غير مدعومة في عمود question_type
- أخطاء إملائية أو مسافات زائدة

**الحلول**:
1. ✅ استخدم القيم الصحيحة فقط:
   - `single_choice`
   - `multiple_choice`
   - `true_false`
   - `short_answer`
2. ✅ تأكد من عدم وجود مسافات قبل أو بعد النص
3. ✅ استخدم حروف صغيرة (lowercase)

---

### ❌ المشكلة: "الإجابة الصحيحة غير صحيحة"

**الأعراض**:
```
السطر 8: الإجابة الصحيحة غير صحيحة في السطر 8
```

**الأسباب**:
- رقم الإجابة خارج النطاق (5, 6...)
- الإجابة لا تطابق أي خيار
- تنسيق خاطئ للإجابات المتعددة

**الحلول**:

#### لأسئلة Single Choice:
```
✅ صحيح: 1, 2, 3, 4
✅ صحيح: A, B, C, D
❌ خطأ: 5, E, X
```

#### لأسئلة Multiple Choice:
```
✅ صحيح: 1,3
✅ صحيح: A,C
✅ صحيح: 1,2,4
❌ خطأ: 1 3 (بدون فاصلة)
❌ خطأ: 1, 3 (مسافة بعد الفاصلة)
```

#### لأسئلة True/False:
```
✅ صحيح: true, false, صحيح, خطأ, 1, 0
❌ خطأ: yes, no, نعم, لا
```

---

### ❌ المشكلة: "يجب أن يكون هناك خياران على الأقل"

**الأعراض**:
```
السطر 12: يجب أن يكون هناك خياران على الأقل للأسئلة متعددة الخيارات
```

**الأسباب**:
- أسئلة MCQ لا تحتوي على خيارين على الأقل
- الخيارات فارغة أو تحتوي على مسافات فقط

**الحلول**:
1. ✅ املأ option_1 و option_2 على الأقل
2. ✅ تأكد من أن الخيارات ليست فارغة
3. ✅ لأسئلة MCQ، يجب أن يكون هناك خيارات

---

## مشاكل الترميز والأحرف

### ❌ المشكلة: "أحرف غريبة أو مربعات في العربية"

**الأعراض**:
- النصوص العربية تظهر كمربعات: ▯▯▯
- أحرف غريبة بدلاً من العربية

**الأسباب**:
- الملف ليس محفوظاً بترميز UTF-8
- استخدام برنامج لا يدعم Unicode

**الحلول**:
1. ✅ احفظ الملف بصيغة "Excel Workbook (.xlsx)"
2. ✅ في Google Sheets، استخدم File → Download → Microsoft Excel
3. ✅ تجنب استخدام Notepad لتعديل CSV
4. ✅ استخدم Excel أو Google Sheets مباشرة

---

### ❌ المشكلة: "Malformed UTF-8 characters"

**الأعراض**:
```
Datatables warning: Malformed UTF-8 characters, possibly incorrectly encoded
```

**الأسباب**:
- مشاكل في ترميز الأحرف العربية
- خلط بين UTF-8 و Windows-1256

**الحلول**:
1. ✅ افتح الملف في Excel الأصلي (ليس LibreOffice)
2. ✅ احفظه كـ "Excel Workbook (.xlsx)"
3. ✅ لا تستخدم "Save As CSV" ثم تعيد التحويل

---

## مشاكل البيانات

### ❌ المشكلة: "النقاط يجب أن تكون رقم صحيح"

**الأعراض**:
```
السطر 7: النقاط يجب أن تكون رقم صحيح في السطر 7
```

**الأسباب**:
- إدخال نص بدلاً من رقم في عمود points
- استخدام أرقام عشرية (1.5)
- ترك الخلية فارغة

**الحلول**:
1. ✅ استخدم أرقام صحيحة فقط: 1, 2, 3, 4...
2. ✅ لا تستخدم كسور عشرية: ❌ 1.5, 2.5
3. ✅ لا تترك الخلية فارغة، استخدم 1 كقيمة افتراضية

---

### ❌ المشكلة: "نص السؤال مطلوب"

**الأعراض**:
```
السطر 10: نص السؤال مطلوب في السطر 10
```

**الأسباب**:
- خلية question_text_ar فارغة
- تحتوي على مسافات فقط

**الحلول**:
1. ✅ تأكد من كتابة نص السؤال
2. ✅ لا تترك الخلية فارغة
3. ✅ احذف المسافات الزائدة

---

## مشاكل الاستيراد

### ❌ المشكلة: "حدث خطأ أثناء استيراد الأسئلة"

**الأعراض**:
```
حدث خطأ أثناء استيراد الأسئلة: [error message]
```

**الأسباب محتملة**:
- خطأ في الاتصال بقاعدة البيانات
- مشكلة في الخادم
- بيانات غير متوافقة

**الحلول**:
1. ✅ أعد المحاولة بعد بضع دقائق
2. ✅ تأكد من اتصالك بالإنترنت
3. ✅ جرب ملف أصغر (5-10 أسئلة) للاختبار
4. ✅ تواصل مع الدعم الفني

---

### ❌ المشكلة: "تم الاستيراد لكن الأسئلة لا تظهر"

**الأعراض**:
- رسالة نجاح الاستيراد
- لكن عدد الأسئلة صفر أو لا تظهر الأسئلة

**الأسباب**:
- مشكلة في العرض (cache)
- خطأ في البيانات المستوردة

**الحلول**:
1. ✅ حدّث الصفحة (F5 أو Ctrl+R)
2. ✅ امسح ذاكرة التخزين المؤقت للمتصفح
3. ✅ سجل خروج ثم دخول مرة أخرى
4. ✅ جرب متصفح مختلف

---

## مشاكل الأداء

### ❌ المشكلة: "الاستيراد يستغرق وقتاً طويلاً"

**الأعراض**:
- الاستيراد يأخذ أكثر من 5 دقائق
- الصفحة تبدو متجمدة

**الأسباب**:
- عدد كبير من الأسئلة (أكثر من 500)
- اتصال إنترنت بطيء
- مشكلة في الخادم

**الحلول**:
1. ✅ قسم الملف إلى ملفات أصغر (50-100 سؤال)
2. ✅ تأكد من سرعة اتصالك بالإنترنت
3. ✅ أغلق التبويبات الأخرى في المتصفح
4. ✅ جرب في وقت مختلف من اليوم

---

### ❌ المشكلة: "انقطع الاتصال أثناء الرفع"

**الأعراض**:
```
Network Error
Connection Timeout
```

**الأسباب**:
- انقطاع الإنترنت
- مهلة الخادم (timeout)
- ملف كبير جداً

**الحلول**:
1. ✅ تأكد من استقرار الإنترنت
2. ✅ قلل حجم الملف (أقل من 5 MB)
3. ✅ أعد المحاولة بعد بضع دقائق
4. ✅ استخدم اتصال سلكي بدلاً من WiFi

---

## نصائح للوقاية

### قبل البدء
1. ✅ نزّل القالب الرسمي دائماً
2. ✅ احفظ نسخة احتياطية من ملفك
3. ✅ اقرأ الوثائق أولاً
4. ✅ جرّب بملف صغير أولاً (5-10 أسئلة)

### أثناء الملء
1. ✅ راجع كل سطر قبل الانتقال للتالي
2. ✅ احفظ الملف باستمرار
3. ✅ لا تحذف أو تعيد تسمية الأعمدة
4. ✅ استخدم Copy-Paste للنصوص فقط (ليس التنسيقات)

### قبل الرفع
1. ✅ راجع القائمة في [validation-rules.md](validation-rules.md)
2. ✅ تأكد من عدم وجود أسطر فارغة
3. ✅ احفظ بصيغة .xlsx
4. ✅ تحقق من الحجم (أقل من 10 MB)

---

## الحصول على المساعدة

إذا استمرت المشكلة بعد تطبيق الحلول:

### 1. جمع المعلومات
- رقم السطر الذي يحتوي على الخطأ
- رسالة الخطأ الكاملة
- لقطة شاشة إن أمكن
- نوع المتصفح والإصدار

### 2. راجع الوثائق
- [دليل الاستيراد](import-guide.md)
- [تنسيق Excel](excel-format.md)
- [قواعد التحقق](validation-rules.md)

### 3. تواصل مع الدعم
قدم التفاصيل التالية:
- وصف المشكلة
- الخطوات التي جربتها
- رسالة الخطأ
- ملف Excel المسبب للمشكلة (إن أمكن)

---

## أسئلة شائعة

**س: هل يمكنني استيراد نفس الملف مرتين؟**
ج: نعم، سينشئ النظام اختبار جديد في كل مرة.

**س: ماذا لو نسيت سؤال؟**
ج: يمكنك إضافته يدوياً بعد الاستيراد أو إعادة الاستيراد بملف جديد.

**س: هل يمكنني تعديل الأسئلة بعد الاستيراد؟**
ج: نعم، جميع الأسئلة قابلة للتعديل بعد الاستيراد.

**س: لماذا لا يستورد النظام الأسئلة واحداً تلو الآخر؟**
ج: لضمان جودة البيانات، يتحقق النظام من جميع الأسئلة أولاً. إذا فشل أي سؤال، لن يتم استيراد أي شيء.
